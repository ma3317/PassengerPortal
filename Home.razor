@page "/"
@using PassengerPortal.Shared.Models
@inject HttpClient Http

<PageTitle>Home</PageTitle>

<div class="main-container">
    <div class="delay-card">
        <h2>Opóźnienia</h2>
        <p><a href="/add-delay">Kliknij, aby dodać nowe opóźnienia</a></p>
        
        <h3>Aktualne opóźnienia pociągów</h3>
        <table>
            <thead>
                <tr>
                    <th>Numer pociągu</th>
                    <th>Relacja</th>
                    <th>Godzina odjazdu</th>
                    <th>Opóźnienie (min)</th>
                    <th>Akcje</th>
                </tr>
            </thead>
            <tbody>
                @if (Delays.Any())
                {
                    foreach (var delay in Delays)
                    {
                        <tr>
                            <td>@delay.TrainNumber</td>
                            <td>@delay.Route</td>
                            <td>@delay.DepartureTime</td>
                            <td>@delay.DelayInMinutes</td>
                            
                        </tr>
                    }
                }
            </tbody>
        </table>
    </div>
    <div class="right-section">
        <div class="about-card">
            <h2>O aplikacji</h2>
            <p>Witaj na Passenger Portal – kompanie twojej podróży i wiarygodnym narzędziu do planowania podróży pociągiem, serduszkowania twoich ulubionych lokomotyw,
                i pozostawania na bieżąco z każdym opóźnieniem!</p>
        </div>
        <p></p>
        <div class="image-card">
            <img src="images/train.jpg" alt="Train Image" class="rounded-image" />
        </div>
    </div>
</div>

@code {
    private List<Delay> Delays = new();

    protected override async Task OnInitializedAsync()
    {
        try
        {
            Delays = await Http.GetFromJsonAsync<List<Delay>>("api/Delays");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error fetching delays: {ex.Message}");
        }
    }
}
